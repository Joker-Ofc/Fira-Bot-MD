const dns=require("dns"),fetch=require("node-fetch"),ipRange=require("ip-range-check"),CF_RANGE=["173.245.48.0/20","103.21.244.0/22","103.22.200.0/22","103.31.4.0/22","141.101.64.0/18","108.162.192.0/18","190.93.240.0/20","188.114.96.0/20","197.234.240.0/22","198.41.128.0/17","162.158.0.0/15","104.16.0.0/13","104.24.0.0/14","172.64.0.0/13","131.0.72.0/22"];module.exports=async e=>{async function o(e){console.log("Checking DNS: "+e);try{let o=await dns.promises.resolve4(e),n=ipRange(o[0],CF_RANGE);return console.log(`${e}: ${o}`),console.log("CloudFlare Proxy: "+(n?"Yes":"No")),console.log(""),{domain:e,dns:o,cf_proxy:n}}catch(o){return console.log(`DNS Inactive: ${e}`),console.log(""),{domain:e,dns:null}}}let n=[],t=[];for(let o of await(await fetch(`https://crt.sh/?q=${e}&output=json`)).json())o.name_value.split("\n").map((e=>n.push(e)));for(let e of[...new Set(n.filter((e=>!e.startsWith("*"))))])respon=await o(e),t.push(respon);return t};