const axios=require("axios"),cheerio=require("cheerio");module.exports=function(e){return query=encodeURIComponent(e),new Promise((async function(t,a){let l=await axios.get("https://kusonime.com/?s="+query);const i=await cheerio.load(l.data),s=await i('div[class="content"] > h2 > a');let r=await s.attr("href");if(!r)return a({status:404,message:`Anime ${e} Tidak Ditemukan!`});let c=await axios.get(r),p=await([]),n=await([]),o=await([]),d=await([]);const g=await cheerio.load(c.data),h=g('div[class="venser"]').find('div[class="lexot"]').children('div[class="info"]');await g(".dlbod > .smokeddl > .smokeurl > a").each((async(e,t)=>{let a=await g(t).attr("href");await p.push({link360:a})})),await g(".dlbod > .smokeddl > .smokeurl + .smokeurl > a").each((async(e,t)=>{let a=await g(t).attr("href");await n.push({link480:a})})),await g(".dlbod > .smokeddl > .smokeurl + .smokeurl + .smokeurl > a").each((async(e,t)=>{let a=await g(t).attr("href");await o.push({link720:a})})),await g(".dlbod > .smokeddl > .smokeurl + .smokeurl + .smokeurl + .smokeurl > a").each((async(e,t)=>{let a=await g(t).attr("href");await d.push({link1080:a})}));let u=await g('div[class="post-thumb"] > h1[class="jdlz"]').text(),w=await g('div[class="info"] > p:nth-child(2)').text(),m=await g('div[class="info"] > p:nth-child(7)').text(),k=await g('div[class="info"] > p:nth-child(9)').text(),f=await g('div[class="info"] > p:nth-child(10)').text(),x=await JSON.stringify(p).replace(/,/g,"\n").replace(/"/g,"").replace(/link360/g,"").replace(/{/g,"").replace(/}/g,"").replace(/\[/g,"").replace(/\]/g,""),v=await JSON.stringify(n).replace(/,/g,"\n").replace(/"/g,"").replace(/link480/g,"").replace(/{/g,"").replace(/}/g,"").replace(/\[/g,"").replace(/\]/g,""),y=await JSON.stringify(o).replace(/,/g,"\n").replace(/"/g,"").replace(/link720/g,"").replace(/{/g,"").replace(/}/g,"").replace(/\[/g,"").replace(/\]/g,""),b=await JSON.stringify(d).replace(/,/g,"\n").replace(/"/g,"").replace(/link1080/g,"").replace(/{/g,"").replace(/}/g,"").replace(/\[/g,"").replace(/\]/g,""),S=g('div[class="post-thumb"] > img').attr("src"),q=g('div[class="venser"]').find('div[class="lexot"]').children("p").first().text(),J=g(h.children("p").get(4)).text().split(":")[1].trim(),N=g(h.children("p").get(7)).text().split(":")[1].trim(),O=g(h.children("p").get(5)).text().split(":")[1].trim(),j=g(h.children("p").get(3)).text().split(":")[1].trim();t({status:c.status,creator:"Caliph",result:{judul:u,thumb:S,desk:q,genre:w.split(": ")[1],status:O,produser:j,rate:N,type:J,link:r,total_eps:m.split(": ")[1],durasi:k.split(": ")[1],tgl_rilis:f.split(": ")[1],result:{360:[...new Set(x.replace(/:/g,"").replace(/https\/\//g,"https://").split("\n"))],480:[...new Set(v.replace(/:/g,"").replace(/https\/\//g,"https://").split("\n"))],720:[...new Set(y.replace(/:/g,"").replace(/https\/\//g,"https://").split("\n"))],1080:[...new Set(b.replace(/:/g,"").replace(/https\/\//g,"https://").split("\n"))]}}})}))}.bind();